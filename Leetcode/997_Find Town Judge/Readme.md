Naive Solution is simple, try doing it with Topological Sort.
